{% extends 'blog/base.html' %}
{% load static %}

{% block content %}
<div class="admin-dashboard">

  {# === ìƒë‹¨: í˜„ì¬ í˜¼ì¡ë„ ìš”ì•½ ì¹´ë“œ === #}
  {% with latest=posts.0 %}
  <section class="admin-hero-card">
    <div class="hero-top-row">
      <div class="hero-title-block">
        <p class="hero-page-title">í•™ìƒì‹ë‹¹</p>
        <p class="hero-page-subtitle">ì‹¤ì‹œê°„ í˜¼ì¡ë„ Â· ê´€ë¦¬ì í™”ë©´</p>
      </div>
      <div class="hero-time-block">
        <span class="hero-time-icon">ğŸ•’</span>
        {% if latest %}
          <span class="hero-time-text">
            {{ latest.published_date|date:"Yë…„ nì›” jì¼ H:i" }} ê¸°ì¤€
          </span>
        {% else %}
          <span class="hero-time-text">ë°ì´í„° ì—†ìŒ</span>
        {% endif %}
      </div>
    </div>

    <div class="hero-main-row">
      <div class="hero-image-wrapper">
        {% if latest and latest.image %}
          <img src="{{ latest.image.url }}" alt="{{ latest.title }}">
        {% else %}
          <img src="{% static 'blog_image/default_error.png' %}" alt="ê¸°ë³¸ ì´ë¯¸ì§€">
        {% endif %}
      </div>

      <div class="hero-right-panel">
        <div class="hero-status-row">
          {% if latest %}
            {% if "ì—¬ìœ " in latest.title %}
              <span class="status-pill status-low">ğŸ˜Š ì—¬ìœ </span>
            {% elif "ë³´í†µ" in latest.title %}
              <span class="status-pill status-mid">ğŸ™‚ ë³´í†µ</span>
            {% else %}
              <span class="status-pill status-high">ğŸš¨í˜¼ì¡</span>
            {% endif %}
          {% else %}
            <span class="status-pill status-unknown">ë°ì´í„° ì—†ìŒ</span>
          {% endif %}
          <span class="status-label">í˜„ì¬ í˜¼ì¡ë„</span>
        </div>

        <p class="hero-description">
          {% if latest %}
            {{ latest.text|linebreaksbr }}
          {% else %}
            ì•„ì§ ê°ì§€ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ì¹´ë©”ë¼ì™€ YOLO ì„œë²„ë¥¼ ì‹¤í–‰í•˜ë©´ ì´ê³³ì—ì„œ ìƒíƒœê°€ ê°±ì‹ ë©ë‹ˆë‹¤.
          {% endif %}
        </p>

        <div class="hero-quick-stats">
          <div class="hero-stat-card">
            <p class="stat-label">ì˜¤ëŠ˜ ë“±ë¡ëœ ì•Œë¦¼</p>
            <p class="stat-value">{{ posts|length }}ê±´</p>
      </div>
    </div>
  </section>
  {% endwith %}

  {# === í•˜ë‹¨: ì‹¤ì‹œê°„ ì•Œë¦¼ ì¹´ë“œ ê·¸ë¦¬ë“œ === #}
  <section class="admin-feed-section">
    <div class="feed-header-row">
      <h2>ì‹¤ì‹œê°„ ì•Œë¦¼ í”¼ë“œ</h2>
      <span class="feed-count">{{ posts|length }}ê±´</span>
    </div>

    {% if posts %}
      <div class="feed-grid">
        {% for post in posts %}
          <article class="feed-card">
            <div class="feed-image">
              {% if post.image %}
                <img src="{{ post.image.url }}" alt="{{ post.title }}">
              {% else %}
                <img src="{% static 'blog_image/default_error.png' %}" alt="ê¸°ë³¸ ì´ë¯¸ì§€">
              {% endif %}
            </div>

            <div class="feed-body">
              <div class="feed-status-row">
                {% if "ì—¬ìœ " in post.title %}
                  <span class="feed-pill pill-low">ì—¬ìœ </span>
                {% elif "ë³´í†µ" in post.title %}
                  <span class="feed-pill pill-mid">ë³´í†µ</span>
                {% else %}
                  <span class="feed-pill pill-high">í˜¼ì¡</span>
                {% endif %}
                <span class="feed-time">
                  {{ post.published_date|date:"Yë…„ nì›” jì¼ H:i" }}
                </span>
              </div>

              <h3 class="feed-title">
                {{ post.title }}
              </h3>
              <p class="feed-text">
                {{ post.text|truncatewords:18 }}
              </p>
            </div>

            <div class="feed-actions">
              <a href="{% url 'post_detail' pk=post.pk %}" class="btn btn-sm">ìƒì„¸ ë³´ê¸°</a>
              <a href="{% url 'post_edit'   pk=post.pk %}" class="btn btn-sm secondary">ìˆ˜ì •</a>
              <a href="{% url 'post_delete' pk=post.pk %}" class="btn btn-sm danger">ì‚­ì œ</a>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p class="empty-text">
        ì•„ì§ ì•Œë¦¼ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. í˜¼ì¡ë„ ìƒíƒœê°€ ë³€í•  ë•Œë§ˆë‹¤ ì´ê³³ì— ì¹´ë“œê°€ ìë™ìœ¼ë¡œ ìŒ“ì…ë‹ˆë‹¤.
      </p>
    {% endif %}
  </section>

</div>
{% endblock %}
